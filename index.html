<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>轻记账 Pro | Web 版</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body>
    <div class="app-shell">
        <header class="topbar">
            <div class="brand">
                <h1>轻记账 Pro</h1>
                <p>记录每一笔，掌握现金流</p>
            </div>
            <div class="topbar-actions">
                <label class="inline-field">
                    <span>概览月份</span>
                    <input id="overviewMonth" type="month" class="field">
                </label>
                <button id="quickAddBtn" class="btn btn-primary">+ 记一笔</button>
            </div>
        </header>

        <nav class="tabs">
            <button class="tab-btn active" data-tab="overview">仪表盘</button>
            <button class="tab-btn" data-tab="transactions">流水</button>
            <button class="tab-btn" data-tab="budget">预算</button>
            <button class="tab-btn" data-tab="settings">设置</button>
        </nav>

        <main class="main-content">
            <section id="overview" class="tab-panel active">
                <div class="panel-header">
                    <h2>财务概览</h2>
                    <p id="overviewMonthLabel">本月收支统计</p>
                </div>

                <div class="stats-grid">
                    <article class="stat-card">
                        <span class="label">当前总资产</span>
                        <strong id="statBalance" class="value">¥0.00</strong>
                    </article>
                    <article class="stat-card">
                        <span class="label">当月收入</span>
                        <strong id="statIncome" class="value income">¥0.00</strong>
                    </article>
                    <article class="stat-card">
                        <span class="label">当月支出</span>
                        <strong id="statExpense" class="value expense">¥0.00</strong>
                    </article>
                    <article class="stat-card">
                        <span class="label">当月结余率</span>
                        <strong id="statSavingRate" class="value">0%</strong>
                    </article>
                </div>

                <div class="charts-grid">
                    <article class="panel">
                        <h3>最近 6 个月趋势</h3>
                        <canvas id="monthlyTrendChart" height="220"></canvas>
                    </article>
                    <article class="panel">
                        <h3>当月支出分类占比</h3>
                        <canvas id="expenseCategoryChart" height="220"></canvas>
                    </article>
                    <article class="panel">
                        <h3>账户余额分布</h3>
                        <canvas id="accountBalanceChart" height="220"></canvas>
                    </article>
                </div>

                <article class="panel">
                    <h3>最近流水</h3>
                    <div id="recentTransactions" class="recent-list"></div>
                </article>
            </section>

            <section id="transactions" class="tab-panel">
                <div class="layout-split">
                    <article class="panel">
                        <h2 id="transactionFormTitle">新增流水</h2>
                        <div class="form-grid">
                            <label>
                                日期
                                <input id="txDate" type="date" class="field">
                            </label>
                            <label>
                                类型
                                <select id="txType" class="field">
                                    <option value="expense">支出</option>
                                    <option value="income">收入</option>
                                </select>
                            </label>
                            <label>
                                金额
                                <input id="txAmount" type="number" min="0" step="0.01" class="field" placeholder="0.00">
                            </label>
                            <label>
                                账户
                                <select id="txAccount" class="field"></select>
                            </label>
                            <label>
                                分类
                                <select id="txCategory" class="field"></select>
                            </label>
                            <label class="full-width">
                                备注
                                <input id="txNote" type="text" maxlength="60" class="field" placeholder="可选，最多 60 字">
                            </label>
                        </div>
                        <div class="actions">
                            <button id="saveTxBtn" class="btn btn-primary">保存流水</button>
                            <button id="resetTxBtn" class="btn btn-secondary">重置表单</button>
                        </div>
                    </article>

                    <article class="panel">
                        <h2>筛选条件</h2>
                        <div class="form-grid">
                            <label>
                                月份
                                <input id="filterMonth" type="month" class="field">
                            </label>
                            <label>
                                类型
                                <select id="filterType" class="field">
                                    <option value="">全部</option>
                                    <option value="expense">仅支出</option>
                                    <option value="income">仅收入</option>
                                </select>
                            </label>
                            <label>
                                分类
                                <select id="filterCategory" class="field"></select>
                            </label>
                            <label>
                                关键词
                                <input id="filterKeyword" type="text" class="field" placeholder="搜索备注/分类/账户">
                            </label>
                        </div>
                        <div class="actions">
                            <button id="clearFiltersBtn" class="btn btn-secondary">清空筛选</button>
                        </div>
                    </article>
                </div>

                <article class="panel">
                    <div class="summary-strip">
                        <span>筛选后收入：<strong id="filteredIncome">¥0.00</strong></span>
                        <span>筛选后支出：<strong id="filteredExpense">¥0.00</strong></span>
                        <span>净额：<strong id="filteredNet">¥0.00</strong></span>
                    </div>

                    <div class="table-wrapper">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>日期</th>
                                    <th>类型</th>
                                    <th>分类</th>
                                    <th>账户</th>
                                    <th>备注</th>
                                    <th class="right">金额</th>
                                    <th class="right">操作</th>
                                </tr>
                            </thead>
                            <tbody id="transactionsTableBody"></tbody>
                        </table>
                    </div>
                </article>
            </section>

            <section id="budget" class="tab-panel">
                <div class="layout-split">
                    <article class="panel">
                        <h2>设置分类预算</h2>
                        <div class="form-grid">
                            <label>
                                预算月份
                                <input id="budgetMonth" type="month" class="field">
                            </label>
                            <label>
                                支出分类
                                <select id="budgetCategory" class="field"></select>
                            </label>
                            <label>
                                预算金额
                                <input id="budgetAmount" type="number" min="0" step="0.01" class="field" placeholder="0.00">
                            </label>
                        </div>
                        <div class="actions">
                            <button id="saveBudgetBtn" class="btn btn-primary">保存预算</button>
                        </div>
                    </article>

                    <article class="panel">
                        <h2>预算执行汇总</h2>
                        <p id="budgetSummaryText">请选择月份查看预算执行情况。</p>
                        <div id="budgetList" class="budget-list"></div>
                    </article>
                </div>
            </section>

            <section id="settings" class="tab-panel">
                <div class="settings-grid">
                    <article class="panel">
                        <h2>账户管理</h2>
                        <div id="accountList" class="settings-list"></div>
                        <div class="form-grid compact">
                            <label>
                                名称
                                <input id="newAccountName" type="text" class="field" placeholder="如：招商银行卡">
                            </label>
                            <label>
                                图标
                                <input id="newAccountIcon" type="text" class="field" maxlength="2" placeholder="🏦">
                            </label>
                            <label>
                                颜色
                                <input id="newAccountColor" type="color" class="field color-field" value="#6366f1">
                            </label>
                            <label>
                                初始余额
                                <input id="newAccountInitialBalance" type="number" step="0.01" class="field" value="0">
                            </label>
                        </div>
                        <div class="actions">
                            <button id="addAccountBtn" class="btn btn-secondary">新增账户</button>
                        </div>
                    </article>

                    <article class="panel">
                        <h2>分类管理</h2>
                        <div id="categoryList" class="settings-list"></div>
                        <div class="form-grid compact">
                            <label>
                                名称
                                <input id="newCategoryName" type="text" class="field" placeholder="如：旅游">
                            </label>
                            <label>
                                类型
                                <select id="newCategoryType" class="field">
                                    <option value="expense">支出</option>
                                    <option value="income">收入</option>
                                </select>
                            </label>
                            <label>
                                图标
                                <input id="newCategoryIcon" type="text" class="field" maxlength="2" placeholder="🧳">
                            </label>
                            <label>
                                颜色
                                <input id="newCategoryColor" type="color" class="field color-field" value="#f97316">
                            </label>
                        </div>
                        <div class="actions">
                            <button id="addCategoryBtn" class="btn btn-secondary">新增分类</button>
                        </div>
                    </article>

                    <article class="panel">
                        <h2>数据管理</h2>
                        <div class="actions">
                            <button id="exportDataBtn" class="btn btn-secondary">导出数据</button>
                            <button id="importDataBtn" class="btn btn-secondary">导入数据</button>
                            <button id="clearDataBtn" class="btn btn-danger">清空所有数据</button>
                        </div>
                        <input id="importFileInput" type="file" accept=".json" hidden>
                    </article>

                    <article class="panel">
                        <h2>系统信息</h2>
                        <div id="dataStats" class="system-info"></div>
                        <p>上次导出：<span id="lastBackupTime">-</span></p>
                    </article>
                </div>
            </section>
        </main>
    </div>

    <div id="toast" class="toast"></div>

    <script src="script.js"></script>
</body>
</html>
